<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>white chat - Bootdey.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="image/x-icon" href="logo/favicon.ico" rel="shortcut icon"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
            integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nicescroll/3.7.6/jquery.nicescroll.min.js"
            integrity="sha512-zMfrMAZYAlNClPKjN+JMuslK/B6sPM09BGvrWlW+cymmPmsUT1xJF3P4kxI3lOh9zypakSgWaTpY6vDJY/3Dig=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.4.0/sockjs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <style type="text/css">
        body {
            overflow: hidden;
            margin-top: 20px;
            max-height: 100%;
        }

        .chat-online {
            color: #34ce57
        }

        .chat-offline {
            color: #e4606d
        }

        .chat-messages {
            display: flex;
            flex-direction: column;
            max-height: 800px;
            overflow-y: scroll;
        }

        .chat-message-left,
        .chat-message-right {
            display: flex;
            flex-shrink: 0
        }

        .chat-message-left {
            margin-right: auto;
        }

        .chat-message-right {
            flex-direction: row-reverse;
            margin-left: auto
        }

        .py-3 {
            padding-top: 1rem !important;
            padding-bottom: 1rem !important;
        }

        .px-4 {
            padding-right: 1.5rem !important;
            padding-left: 1.5rem !important;
        }

        .flex-grow-0 {
            flex-grow: 0 !important;
        }

        .border-top {
            border-top: 1px solid #dee2e6 !important;
        }
    </style>
</head>

<body>
<main class="content ">
    <div class="container-fluid p-0">
        <h1 class="h3 mx-5">Doi den Messages</h1>
        <div class="card">
            <div class="row g-0">

                <!--Friend List-->

                <div class="col-sm-12 col-xl-3 border-right min-vh-100">
                    <div class="px-4 d-none d-md-block">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <input type="text" class="form-control my-3" placeholder="Search...">
                            </div>
                        </div>
                    </div>
                    <div id="roomList">

                    </div>


                    <hr class="d-block d-lg-none mt-1 mb-0 ">
                </div>


                <!--Chat Box-->


                <div class="col-sm-12 col-xl-7 border-right min-vh-100">
                    <div class=" px-4 border-bottom d-none d-lg-block ">
                        <div class="d-flex align-items-center py-1 ">
                            <div class="position-relative ">
                                <img src="https://bootdey.com/img/Content/avatar/avatar3.png "
                                     class="rounded-circle mr-1 " alt="Sharon Lessman " width="40 " height="40 ">
                            </div>
                            <div class="flex-grow-1 pl-3 ">
                                <strong>Sharon Lessman</strong>
                            </div>
                            <div>
                                <button class="btn btn-primary btn-lg mr-1 px-3 ">
                                    <svg xmlns="http://www.w3.org/2000/svg " width="20 " height="20 "
                                         viewbox="0 0 24 24 " fill="none " stroke="currentColor " stroke-width="2 "
                                         stroke-linecap="round
                            " stroke-linejoin="round " class="feather feather-phone feather-lg ">
                                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81
                            2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z "></path>
                                    </svg>
                                </button>
                                <button class="btn btn-info btn-lg mr-1 px-3 d-none d-md-inline-block ">
                                    <svg xmlns="http://www.w3.org/2000/svg " width="20 " height="20 "
                                         viewbox="0 0 24 24 " fill="none " stroke="currentColor " stroke-width="2
                            " stroke-linecap="round " stroke-linejoin="round "
                                         class="feather feather-video feather-lg ">
                                        <polygon points="23 7 16 12 23 17 23 7 "></polygon>
                                        <rect x="1 " y="5 " width="15 " height="14 " rx="2 " ry="2 "></rect>
                                    </svg>
                                </button>
                                <button class="btn btn-light border btn-lg px-3 ">
                                    <svg xmlns="http://www.w3.org/2000/svg " width="20 " height="20 "
                                         viewbox="0 0 24 24 " fill="none " stroke="currentColor " stroke-width="2 "
                                         stroke-linecap="round
                            " stroke-linejoin="round " class="feather feather-more-horizontal feather-lg ">
                                        <circle cx="12 " cy="12 " r="1 "></circle>
                                        <circle cx="19 " cy="12 " r="1 "></circle>
                                        <circle cx="5 " cy="12 " r="1 "></circle>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="position-relative chat-box">
                        <div class="chat-messages p-4" id="chat-box-room">

                        </div>
                    </div>
                    <div class="flex-grow-0 py-3 px-4 border-top d-flex align-self-end">
                        <div class="input-group ">
                            <input type="text" id="message" class="form-control" placeholder="Type your message ">
                            <button class="btn btn-primary" onclick="sendMessage()">Send</button>
                        </div>
                    </div>
                </div>


                <!--Information-->
                <div class="col-sm-12 col-xl-2">
                    <div class="d-flex justify-content-center mt-3 ">
                        <div class="position-relative ">
                            <img src="https://bootdey.com/img/Content/avatar/avatar3.png " class="rounded-circle mr-1 "
                                 alt="Sharon Lessman " width="100 " height="100 ">
                        </div>
                    </div>

                    <div class="d-flex justify-content-center mt-3 ">
                        <div>
                            <h3>Sharon Lessman</h3>
                        </div>
                    </div>

                    <div class="d-flex justify-content-center ">
                        <button class="btn btn-secondary mx-2 "><i class="bi bi-bell-fill "></i></button>
                        <button class="btn btn-secondary mx-2 "><i class="bi bi-facebook "></i></button>
                        <button class="btn btn-secondary mx-2 "><i class="bi bi-search "></i></button>
                    </div>

                </div>
            </div>
        </div>
    </div>
</main>
<link rel="stylesheet " href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css "
      integrity="sha384-b6lVK+yci+bfDmaY1u0zE8YYJt0TZxLEAFyYSLHId4xoVvsrQu3INevFKo+Xir8e " crossorigin="anonymous ">
<script src="https://code.jquery.com/jquery-1.10.2.min.js "></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js "></script>
<script type="text/javascript ">
    document.addEventListener('DOMContentLoaded', function () {
        var chatBoxRoom = document.getElementById('chat-box-room');
        chatBoxRoom.scrollTop = chatBoxRoom.scrollHeight - chatBoxRoom.clientHeight;
    });
    const url = 'http://localhost:8888';
    var selectedRoom = -1;
    var chatInSelectedRoom;
    var userInSelectedRoom;
    var stompClient;
    var allUser = new Map();
    var allMessage = new Map();
    var token = localStorage.getItem("userToken");
    console.log(token);

    var userId = JSON.parse(atob(token)).userId;
    console.log(userId);


    function getAllUser() {
        console.log("getAllUser");
        $.get("http://localhost:8888/getAllUser?token=" + token, function (data) {
            let users = data;
            for (let i = 0; i < users.length; i++) {
                console.log(users[i]);
                allUser[users[i].userId] = users[i];
            }
        }).fail(function (error) {
            console.log("Error in Fetch All Room");
        });
    }


    function fetchAllRoom() {
        $.get("http://localhost:8888/fetchAllRoom?token=" + token, function (data) {
            console.log(data);
            let rooms = data;
            let roomTemplateHtml = "";
            for (let i = 0; i < rooms.length; i++) {
                console.log("i = " + i + rooms[i].roomType);
                if (rooms[i].roomType == false) {
                    if (rooms[i].user1 == userId) {
                        roomTemplateHtml = roomTemplateHtml + '<a href="#" id="room' + rooms[i].roomId + '" onclick=changeSelectedRoom(' + rooms[i].roomId + ') class="list-group-item list-group-item-action border-0 ">\n' +
                            '<div id="roomId' + rooms[i].roomId + '" class="badge bg-success float-right "></div> \n' +
                            ' <div class="d-flex align-items-start ">\n' +
                            ' <img src="' + allUser[rooms[i].user2].avatar + '" class="rounded-circle mr-1 " alt="Vanessa Tucker " width="40 " height="40 ">\n' +
                            '<div class="flex-grow-1 ml-3 ">\n' +
                            '' + allUser[rooms[i].user2].username + '\n' +
                            '<div class="small "><span class="fas fa-circle chat-online "></span> Online</div>\n' +
                            '</div>\n' +
                            '</div>\n' +
                            '</a>\n';
                    } else {
                        roomTemplateHtml = roomTemplateHtml + '<a href="#" id="room' + rooms[i].roomId + '" onclick=changeSelectedRoom(' + rooms[i].roomId + ') class="list-group-item list-group-item-action border-0 ">\n' +
                            '<div id="roomId' + rooms[i].roomId + '" class="badge bg-success float-right "></div> \n' +
                            ' <div class="d-flex align-items-start ">\n' +
                            ' <img src="' + allUser[rooms[i].user1].avatar + '" class="rounded-circle mr-1 " alt="Vanessa Tucker " width="40 " height="40 ">\n' +
                            '<div class="flex-grow-1 ml-3 ">\n' +
                            '' + allUser[rooms[i].user1].username + '\n' +
                            '<div class="small "><span class="fas fa-circle chat-online "></span> Online</div>\n' +
                            '</div>\n' +
                            '</div>\n' +
                            '</a>\n';
                    }
                } else {
                    if (rooms[i].roomImage != null) {
                        roomTemplateHtml = roomTemplateHtml + '<a href="#" id="room' + rooms[i].roomId + '" onclick=changeSelectedRoom(' + rooms[i].roomId + ') class="list-group-item list-group-item-action border-0 ">\n' +
                            '<div id="roomId' + rooms[i].roomId + '" class="badge bg-success float-right "></div> \n' +
                            ' <div class="d-flex align-items-start ">\n' +
                            ' <img src="' + rooms[i].roomImage + '" class="rounded-circle mr-1 " alt="Vanessa Tucker " width="40 " height="40 ">\n' +
                            '<div class="flex-grow-1 ml-3 ">\n' +
                            '' + rooms[i].roomName + '\n' +
                            '<div class="small "><span class="fas fa-circle chat-online "></span> Online</div>\n' +
                            '</div>\n' +
                            '</div>\n' +
                            '</a>\n';
                    } else {
                        roomTemplateHtml = roomTemplateHtml + '<a href="#" id="room' + rooms[i].roomId + '" onclick=changeSelectedRoom(' + rooms[i].roomId + ') class="list-group-item list-group-item-action border-0 ">\n' +
                            '<div id="roomId' + rooms[i].roomId + '" class="badge bg-success float-right "></div> \n' +
                            ' <div class="d-flex align-items-start ">\n' +
                            ' <img src="' + 'https://dummyimage.com/400x400/000/fff' + '" class="rounded-circle mr-1 " alt="Vanessa Tucker " width="40 " height="40 ">\n' +
                            '<div class="flex-grow-1 ml-3 ">\n' +
                            '' + rooms[i].roomName + '\n' +
                            '<div class="small "><span class="fas fa-circle chat-online "></span> Online</div>\n' +
                            '</div>\n' +
                            '</div>\n' +
                            '</a>\n';
                    }
                }


            }
            $('#roomList').html('');
            $('#roomList').html(roomTemplateHtml);
        }).fail(function (error) {
            console.log("Error in Fetch All Room");
        })
    }

    function changeShadowInSeletedRoom(id) {
        if (selectedRoom == -1) {
            document.getElementById("room" + id).classList.add('shadow-lg');
            document.getElementById("room" + id).classList.add('bg-secondary');
            document.getElementById("room" + id).classList.add('text-white');
        } else {
            document.getElementById("room" + selectedRoom).classList.remove('shadow-lg');
            document.getElementById("room" + selectedRoom).classList.remove('bg-secondary');
            document.getElementById("room" + selectedRoom).classList.remove('text-white');
            document.getElementById("room" + id).classList.add('shadow-lg');
            document.getElementById("room" + id).classList.add('bg-secondary');
            document.getElementById("room" + id).classList.add('text-white');
        }
        selectedRoom = id;
    }

    function resetScreen() {
        document.getElementById("chat-box-room").innerHTML = " ";
    }

    function renderChatData(responeData) {
        var data = responeData;
        let chatTemplateHtml = "";
        for (let i = 0; i < data.length; i++) {
            console.log(data[i]);
            if (data[i].userId == userId) {
                if (allUser[data[i].userId].avatar != null) {
                    chatTemplateHtml = chatTemplateHtml +
                        '<div class="chat-message-right mb-4 ">\n' +
                        '<div>\n' +
                        '<img src=" ' + allUser[data[i].userId].avatar + ' " class="rounded-circle mr-1 " alt="Chris Wood " width="40 " height="40 ">\n' +
                        '<div class="text-muted small text-nowrap mt-2 ">2:35 am</div>\n' +
                        '</div>\n' +
                        '<div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3 ">\n' +
                        '<div class="font-weight-bold mb-1 ">You</div>\n' +
                        '' + data[i].message + '\n' +
                        '</div>\n' +
                        '</div>\n'
                } else {
                    chatTemplateHtml = chatTemplateHtml +
                        '<div class="chat-message-right mb-4 ">\n' +
                        '<div>\n' +
                        '<img src=" ' + 'https://dummyimage.com/600x400/f241ae/ffffff' + ' " class="rounded-circle mr-1 " alt="Chris Wood " width="40 " height="40 ">\n' +
                        '<div class="text-muted small text-nowrap mt-2 ">2:35 am</div>\n' +
                        '</div>\n' +
                        '<div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3 ">\n' +
                        '<div class="font-weight-bold mb-1 ">You</div>\n' +
                        '' + data[i].message + '\n' +
                        '</div>\n' +
                        '</div>\n'
                }

            } else {
                if (allUser[data[i].userId].avatar != null) {
                    chatTemplateHtml = chatTemplateHtml +
                        '<div class="chat-message-left pb-4 ">\n' +
                        '<div>\n' +
                        '<img src=" ' + allUser[data[i].userId].avatar + ' " class="rounded-circle mr-1 " alt="Sharon Lessman " width="40 " height="40 ">\n' +
                        '<div class="text-muted small text-nowrap mt-2 ">2:34 am</div>\n' +
                        '</div>\n' +
                        '<div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3 ">\n' +
                        '<div class="font-weight-bold mb-1 ">' + allUser[data[i].userId].username + '</div>\n' +
                        '' + data[i].message + '\n' +
                        '</div>\n' +
                        '</div>\n'
                } else {
                    chatTemplateHtml = chatTemplateHtml +
                        '<div class="chat-message-left pb-4 ">\n' +
                        '<div>\n' +
                        '<img src=" ' + 'https://dummyimage.com/600x400/f241ae/ffffff' + ' " class="rounded-circle mr-1 " alt="Sharon Lessman " width="40 " height="40 ">\n' +
                        '<div class="text-muted small text-nowrap mt-2 ">2:34 am</div>\n' +
                        '</div>\n' +
                        '<div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3 ">\n' +
                        '<div class="font-weight-bold mb-1 ">' + allUser[data[i].userId].username + '</div>\n' +
                        '' + data[i].message + '\n' +
                        '</div>\n' +
                        '</div>\n'
                }

            }
            $('#chat-box-room').html(chatTemplateHtml);
        }
    }

    function fetchChat(roomId) {
        $.get("http://localhost:8888/renderChat?token=" + token + "&roomId=" + roomId, function (data) {
            resetScreen();
            renderChatData(data);
        }).fail(function (error) {
            console.log("Error in Fetch All Room");
        });
    }

    function generateOwnMessage(roomId, message) {
        let chatTemplateHtml = "";
        if (allUser[userId].avatar != null) {
            chatTemplateHtml = chatTemplateHtml +
                '<div class="chat-message-right mb-4 ">\n' +
                '<div>\n' +
                '<img src=" ' + allUser[userId].avatar + ' " class="rounded-circle mr-1 " alt="Chris Wood " width="40 " height="40 ">\n' +
                '<div class="text-muted small text-nowrap mt-2 ">2:35 am</div>\n' +
                '</div>\n' +
                '<div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3 ">\n' +
                '<div class="font-weight-bold mb-1 ">You</div>\n' +
                '' + message + '\n' +
                '</div>\n' +
                '</div>\n'
        } else {
            chatTemplateHtml = chatTemplateHtml +
                '<div class="chat-message-right mb-4 ">\n' +
                '<div>\n' +
                '<img src=" ' + 'https://dummyimage.com/600x400/f241ae/ffffff' + ' " class="rounded-circle mr-1 " alt="Chris Wood " width="40 " height="40 ">\n' +
                '<div class="text-muted small text-nowrap mt-2 ">2:35 am</div>\n' +
                '</div>\n' +
                '<div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3 ">\n' +
                '<div class="font-weight-bold mb-1 ">You</div>\n' +
                '' + message + '\n' +
                '</div>\n' +
                '</div>\n'
        }
        let html = $('#chat-box-room').html();
        $('#chat-box-room').html(html + chatTemplateHtml);
    }

    function generateMessage(roomId, data) {
        let chatTemplateHtml = "";
        if (allUser[data.userId].avatar != null) {
            chatTemplateHtml = chatTemplateHtml +
                '<div class="chat-message-left pb-4 ">\n' +
                '<div>\n' +
                '<img src=" ' + allUser[data.userId].avatar + ' " class="rounded-circle mr-1 " alt="Sharon Lessman " width="40 " height="40 ">\n' +
                '<div class="text-muted small text-nowrap mt-2 ">2:34 am</div>\n' +
                '</div>\n' +
                '<div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3 ">\n' +
                '<div class="font-weight-bold mb-1 ">' + allUser[data.userId].username + '</div>\n' +
                '' + data.message + '\n' +
                '</div>\n' +
                '</div>\n'
        } else {
            chatTemplateHtml = chatTemplateHtml +
                '<div class="chat-message-left pb-4 ">\n' +
                '<div>\n' +
                '<img src=" ' + 'https://dummyimage.com/600x400/f241ae/ffffff' + ' " class="rounded-circle mr-1 " alt="Sharon Lessman " width="40 " height="40 ">\n' +
                '<div class="text-muted small text-nowrap mt-2 ">2:34 am</div>\n' +
                '</div>\n' +
                '<div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3 ">\n' +
                '<div class="font-weight-bold mb-1 ">' + allUser[data.userId].username + '</div>\n' +
                '' + data.message + '\n' +
                '</div>\n' +
                '</div>\n'
        }
        let html = $('#chat-box-room').html();
        $('#chat-box-room').html(html + chatTemplateHtml);
    }

    function connectToChat(userId) {
        console.log("connecting to chat... ")
        let socket = new SockJS(url + '/chat');
        stompClient = Stomp.over(socket);
        stompClient.connect({}, function (frame) {
            console.log("connected to: " + frame);
            stompClient.subscribe("/topic/messages/" + userId, function (response) {
                let data = JSON.parse(response.body);
                if (selectedRoom === data.roomId) {
                    generateMessage(selectedRoom, data);
                } else {
                    $('#roomId' + data.roomId).html("New");
                }
            });
        });
    }

    function sendMsg(pUserId, text, roomId) {
        var date = new Date();
        var dateTime = date.toString() + 'UTC';
        stompClient.send("/app/chat/ " + selectedRoom, {}, JSON.stringify({
            messageId: -1,
            message: text,
            createdDate: null,
            roomId: roomId,
            userId: pUserId
        }));
        generateOwnMessage(roomId, text);
    }


    setTimeout(function () {
        getAllUser();
        setTimeout(function () {
            fetchAllRoom();
        }, 100)
    }, 100)

    connectToChat(userId);


    function changeSelectedRoom(id) {
        changeShadowInSeletedRoom(id);
        fetchChat(id);
    }

    function sendMessage() {
        let message = document.getElementById("message").value;
        sendMsg(userId, message, selectedRoom);
    }

    function resetUnseenMessage(roomId) {
        $('#roomId' + roomId).html("");
    }

    function changeSelectedRoom(room) {
        if (room != selectedRoom) {
            resetScreen();
            chatInSelectedRoom = null;
            selectedRoom = room;
            resetUnseenMessage(room);
            fetchChat(room);
            renderChatData();
        }

    }

    /*

    <div class="chat-message-right mb-4 ">
                                <div>
                                    <img src="https://bootdey.com/img/Content/avatar/avatar1.png " class="rounded-circle mr-1 " alt="Chris Wood " width="40 " height="40 ">
                                    <div class="text-muted small text-nowrap mt-2 ">2:35 am</div>
                                </div>
                                <div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3 ">
                                    <div class="font-weight-bold mb-1 ">You</div>
                                    Cum ea graeci tractatos.
                                </div>
                            </div>

    <div class="chat-message-left pb-4 ">
                                <div>
                                    <img src="https://bootdey.com/img/Content/avatar/avatar3.png " class="rounded-circle mr-1 " alt="Sharon Lessman " width="40 " height="40 ">
                                    <div class="text-muted small text-nowrap mt-2 ">2:34 am</div>
                                </div>
                                <div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3 ">
                                    <div class="font-weight-bold mb-1 ">Sharon Lessman</div>
                                    Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.
                                </div>
                            </div>

    */



    // function getRoomInfo(roomId) {
    //     $.ajax({
    //         url: url + "/renderChat?token=" + token + " roomId " + room,
    //         type: "GET ",
    //         dataType: "text ",
    //         data: "username=" + username + " &password=" + password,
    //         success: function(respone) {
    //             console.log(respone);

    //         },
    //         fail: function(error) {
    //             console.log(error);
    //         }
    //     });
    // }


    // function generateMessage(selectedRoomId, data) {
    //     let userAvatar = "https://user-images.githubusercontent.com/35243461/168796877-f6c8819a-5d6e-4b2a-bd56-04963639239b.jpg";
    //     if(RealetedUserMap.get(data.userId).avatar != null) {
    //         userAvatar = RealetedUserMap.get(data.userId).avatar;
    //     }
    //     let userChatName = "Unknow";
    //     if(RealetedUserMap.get(data.userId).username != null) {
    //         userChatName = RealetedUserMap.get(data.userId).username;
    //     }
    //     var dateString = (messages[i].createdDate + "").split(/-|\s|:/);
    //     var date = new Date(dateString[0], dateString[1] -1, dateString[2], dateString[3], dateString[4], dateString[5]);
    //     let roomChatDateTime = addZeroToAnyThing(date.getHours()) + ':' + addZeroToAnyThing(date.getMinutes());
    //     htmlMessageTemplate = '<div>\n' +
    //                     '<div class="ml-3 mb-0" >\n' +
    //                     '<p style="margin-bottom: 0px; font-size: small; ">' + userChatName + '</p>\n' +
    //                     '</div>\n' +
    //                     '<div class="left-chat-message fs-13 mb-2">\n' +
    //                     '<div class="row">\n' +
    //                     '<div class="col-xl-2 col-sm-3 ">\n' +
    //                     '<img src="' + userAvatar + '" class="rounded-circle mr-1 mb-sm-5 " alt="Chris Wood" width="40" height="40">\n' +
    //                     '</div>\n' +
    //                     '<div class="col-xl-10 col-sm-9">\n' +
    //                     '<p class="mb-0 mr-3 mr-2  pr-4">' + data.message + '</p>\n' +
    //                     '<div class="message-options mt-3">\n' +
    //                     '<div class="message-time">' + roomChatDateTime + '</div>\n' +
    //                     '<div class="message-arrow"><i class="text-muted la la-angle-down fs-17"></i></div>\n' +
    //                     '</div>\n' +
    //                     '</div>\n' +
    //                     '</div>\n' +
    //                     '</div>\n' +
    //                     '</div>\n' ;
    //     $('#chatBoxMessage').html($('#chatBoxMessage').html() + htmlMessageTemplate);
    //     chatRoomMessage.set(selectedRoomId, chatRoomMessage.get(selectedRoomId) + htmlMessageTemplate);  
    //     scrollToBottumByScroll();
    // }

</script>
</body>

</html>